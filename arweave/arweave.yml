  - name: Build arweave image
    community.docker.docker_image:
        name: "{{ arweave }}"
        state: present
        force_absent: true
        build:
          path: "{{ arweave }}/"
          dockerfile: "{{ dockerfile }}"
        source: build

  - name: Start container
    docker_container:
      name: "{{ arweave }}"
      image: "{{ arweave }}"
      state: started
      tty: true
      interactive: true
    register: arweave_container

  # - name: Detach container
  #   docker_container:
  #       name: arweave
  #       command: tail -f /dev/null
  #       detach: true
  #   when: arweave_container.changed


  - name: Generate arweave wallet
    community.docker.docker_container_exec: 
      container: "{{ arweave }}"
      command: sh -c "arweave key-create {{ wallet_file }}"
    register: wallet_create_info

  - name: Generate arweave wallet info
    community.docker.docker_container_exec: 
      container: "{{ arweave }}"
      command: sh -c "arweave key-inspect --key-file {{ wallet_file }} > {{ wallet_info_file }}"
    register: wallet_create_info

  # - name: Copy wallet file
  #   docker_copy:
  #     container: "{{ arweave }}"
  #     src: "{{ wallet_file }}"
  #     dest: "{{ git_dst }}"

  # - name: Copy wallet info file
  #   docker_copy:
  #     container: "{{ arweave }}"
  #     src: "{{ wallet_info_file }}"
  #     dest: "{{ git_dst }}"

  - name: Copy wallet file
    shell: docker cp "{{ arweave }}:/{{ wallet_file }}" "{{ git_dst }}"

  - name: Copy wallet file
    shell: docker cp "{{ arweave }}:/{{ wallet_info_file }}" "{{ git_dst }}"


















  
